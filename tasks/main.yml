---
- name: Stop firewalld service
  service:
    name: firewalld
    state: stopped
    enabled: no
  when: has_firewalld

- name: Mask firewalld service
  systemd:
    name: firewalld
    enabled: no
    masked: yes
  ignore_errors: yes

- name: Set systemd_unit_directory for debian based systems
  set_fact:
    systemd_unit_directory: "/lib/systemd/system"
  when: ansible_distribution == "Debian" or ansible_distribution == "Ubuntu"

- name: Set conf_file_location for debian based systems
  set_fact:
    conf_file_location: "/etc/default"
  when: ansible_distribution == "Debian" or ansible_distribution == "Ubuntu"

- include: ipset.yml

- include: iptables.yml

- name: Install conntrack-tools on Fedora
  action: "{{ ansible_pkg_mgr }}"
  args:
    name: conntrack-tools
    state: latest
  when: ansible_distribution == "Fedora"
