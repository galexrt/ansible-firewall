---
# defaults file for ansible-firewall
firewall_default_chains:
  - INPUT
  - DROP
  - ACCEPT
  - REJECT
  - LOG
  - OUTPUT

firewall_iptables_path: "/usr/sbin/iptables"

firewall_chain_default_policy: "ACCEPT"

firewall_filter_rules:
  - name: 001 accept all to lo interface
    chain: INPUT
    proto: all
    iniface: lo
    jump: ACCEPT
  - name: 004 accept related established rules
    chain: INPUT
    proto: all
    state:
      - RELATED
      - ESTABLISHED
    jump: ACCEPT
  - name: 200 allow outgoing icmp type 8 (ping)
    chain: OUTPUT
    proto: icmp
    icmp: echo-request
    jump: ACCEPT
  - name: 200 allow outgoing dns lookups
    chain: OUTPUT
    state:
      - NEW
    dport: "53"
    proto: udp
    jump: ACCEPT
  - name: 900 log dropped output chain
    chain: OUTPUT
    jump: LOG
    log_level: "6"
    log_prefix: "[IPTABLES OUTPUT] dropped "
    proto: all
  - name: 910 deny all other input requests
    chain: INPUT
    jump: DROP
    proto: all
